<!doctype html>
<html lang="ko" class="h-full">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Cloud Computing Study Dashboard</title>

  <script src="https://cdn.tailwindcss.com"></script>
  <script src="/_sdk/element_sdk.js"></script>

  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link
    href="https://fonts.googleapis.com/css2?family=IBM+Plex+Sans+KR:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap"
    rel="stylesheet"
  />

  <style>
    body { box-sizing: border-box; }
    * { font-family: 'IBM Plex Sans KR', sans-serif; }
    .mono { font-family: 'JetBrains Mono', monospace; }

    .card-hover { transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1); }
    .card-hover:hover { transform: translateY(-4px); box-shadow: 0 20px 40px -12px rgba(0,0,0,0.3); }

    .gradient-border { background: linear-gradient(135deg, #1e293b 0%, #0f172a 100%); position: relative; }
    .gradient-border::before {
      content: '';
      position: absolute;
      inset: 0;
      padding: 1px;
      border-radius: inherit;
      background: linear-gradient(135deg, #38bdf8, #818cf8, #c084fc);
      -webkit-mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
      mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
      -webkit-mask-composite: xor;
      mask-composite: exclude;
    }

    .pulse-dot { animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite; }
    @keyframes pulse { 0%, 100% { opacity: 1; } 50% { opacity: 0.5; } }

    .fade-in { animation: fadeIn 0.5s ease-out forwards; }
    @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

    .section-content { max-height: 0; overflow: hidden; transition: max-height 0.4s ease-out, padding 0.4s ease-out; }
    .section-content.expanded { max-height: 4000px; }

    .checklist-item { transition: all 0.2s ease; }
    .checklist-item.checked { opacity: 0.6; }
    .checklist-item.checked span { text-decoration: line-through; }

    .progress-ring { transition: stroke-dashoffset 0.5s ease; }

    /* âœ… ì½”ë“œë¸”ë¡ ì˜ë¦¼/ê²¹ì¹¨ ìˆ˜ì • í•µì‹¬ */
    .code-wrap { overflow-x: auto; }
    pre, code {
      white-space: pre;
      overflow-x: auto;
      word-break: normal;
      tab-size: 2;
    }
    pre { padding: 0; margin: 0; }
    .code-card {
      background: rgba(15, 23, 42, 0.55);
      border: 1px solid rgba(51, 65, 85, 0.7);
      border-radius: 0.75rem;
      padding: 1rem;
    }

    ::-webkit-scrollbar { width: 8px; height: 10px; }
    ::-webkit-scrollbar-track { background: #1e293b; }
    ::-webkit-scrollbar-thumb { background: #475569; border-radius: 4px; }
    ::-webkit-scrollbar-thumb:hover { background: #64748b; }
  </style>

  <style>@view-transition { navigation: auto; }</style>
  <script src="/_sdk/data_sdk.js" type="text/javascript"></script>
</head>

<body class="h-full m-0 p-0 overflow-auto" style="background: linear-gradient(135deg, #0f172a 0%, #1e1b4b 50%, #0f172a 100%);">
  <div class="min-h-full w-full">
    <!-- Header -->
    <header class="sticky top-0 z-50 backdrop-blur-xl bg-slate-900/80 border-b border-slate-700/50">
      <div class="max-w-7xl mx-auto px-4 sm:px-6 py-4">
        <div class="flex items-center justify-between">
          <div class="flex items-center gap-3">
            <div class="w-10 h-10 rounded-xl bg-gradient-to-br from-cyan-400 to-violet-500 flex items-center justify-center">
              <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                  d="M3 15a4 4 0 004 4h9a5 5 0 10-.1-9.999 5.002 5.002 0 10-9.78 2.096A4.001 4.001 0 003 15z" />
              </svg>
            </div>
            <div>
              <h1 id="main-title" class="text-lg sm:text-xl font-bold text-white">2025 ì „êµ­ê¸°ëŠ¥ê²½ê¸°ëŒ€íšŒ</h1>
              <p id="subtitle" class="text-xs sm:text-sm text-slate-400">í´ë¼ìš°ë“œì»´í“¨íŒ… ì œ3ê³¼ì œ Â· System Operation</p>
            </div>
          </div>

          <div class="flex items-center gap-2">
            <div class="hidden sm:flex items-center gap-2 px-3 py-1.5 rounded-full bg-emerald-500/20 border border-emerald-500/30">
              <span class="w-2 h-2 rounded-full bg-emerald-400 pulse-dot"></span>
              <span class="text-xs text-emerald-400 font-medium">í•™ìŠµ ì¤‘</span>
            </div>

            <div id="progress-container" class="flex items-center gap-2">
              <svg class="w-10 h-10 -rotate-90" viewBox="0 0 36 36">
                <circle cx="18" cy="18" r="15.5" fill="none" stroke="#334155" stroke-width="3" />
                <circle id="progress-ring" class="progress-ring" cx="18" cy="18" r="15.5" fill="none"
                  stroke="url(#gradient)" stroke-width="3" stroke-linecap="round"
                  stroke-dasharray="97.4" stroke-dashoffset="97.4" />
                <defs>
                  <linearGradient id="gradient" x1="0%" y1="0%" x2="100%" y2="0%">
                    <stop offset="0%" stop-color="#38bdf8" />
                    <stop offset="100%" stop-color="#c084fc" />
                  </linearGradient>
                </defs>
              </svg>
              <span id="progress-text" class="text-sm font-semibold text-slate-300 mono">0%</span>
            </div>
          </div>
        </div>
      </div>
    </header>

    <!-- Navigation Pills -->
    <nav class="sticky top-[73px] z-40 backdrop-blur-xl bg-slate-900/60 border-b border-slate-700/30">
      <div class="max-w-7xl mx-auto px-4 sm:px-6 py-3 overflow-x-auto">
        <div class="flex gap-2 min-w-max">
          <button onclick="scrollToSection('overview')"
            class="nav-pill px-4 py-2 rounded-full text-sm font-medium bg-cyan-500/20 text-cyan-400 border border-cyan-500/30 hover:bg-cyan-500/30 transition-all">
            ğŸ“‹ ê°œìš”
          </button>
          <button onclick="scrollToSection('architecture')"
            class="nav-pill px-4 py-2 rounded-full text-sm font-medium bg-slate-700/50 text-slate-300 hover:bg-slate-700 transition-all">
            ğŸ—ï¸ ì•„í‚¤í…ì²˜
          </button>
          <button onclick="scrollToSection('apis')"
            class="nav-pill px-4 py-2 rounded-full text-sm font-medium bg-slate-700/50 text-slate-300 hover:bg-slate-700 transition-all">
            ğŸ”Œ API
          </button>
          <button onclick="scrollToSection('terraform')"
            class="nav-pill px-4 py-2 rounded-full text-sm font-medium bg-slate-700/50 text-slate-300 hover:bg-slate-700 transition-all">
            ğŸ§± Terraform
          </button>
          <button onclick="scrollToSection('checklist')"
            class="nav-pill px-4 py-2 rounded-full text-sm font-medium bg-slate-700/50 text-slate-300 hover:bg-slate-700 transition-all">
            âœ… ì²´í¬ë¦¬ìŠ¤íŠ¸
          </button>
        </div>
      </div>
    </nav>

    <!-- Main Content -->
    <main class="max-w-7xl mx-auto px-4 sm:px-6 py-8 space-y-8">
      <!-- Key Reminder Banner -->
      <div class="gradient-border rounded-2xl p-6 fade-in">
        <div class="flex items-start gap-4">
          <div class="w-12 h-12 rounded-xl bg-gradient-to-br from-amber-400 to-orange-500 flex items-center justify-center flex-shrink-0">
            <span class="text-2xl">ğŸ’¡</span>
          </div>
          <div>
            <h2 class="text-lg font-bold text-white mb-2">ì‹œí—˜ì¥ì—ì„œ ê¼­ ê¸°ì–µí•  ë¬¸ì¥</h2>
            <blockquote class="text-slate-300 italic border-l-4 border-amber-500 pl-4 space-y-2">
              <p>"ì´ ê³¼ì œëŠ” ë§ì´ ë§Œë“œëŠ” ê²ƒì´ ì•„ë‹ˆë¼ <span class="text-amber-400 font-semibold">ì™œ ì´ë ‡ê²Œ ìš´ì˜í•˜ëŠ”ì§€ ì„¤ëª…í•  ìˆ˜ ìˆì–´ì•¼ í•œë‹¤.</span>"</p>
              <p>"ì„±ëŠ¥ë³´ë‹¤ ë¨¼ì € ì§€ì¼œì•¼ í•  ê²ƒì€ <span class="text-amber-400 font-semibold">ê°€ìš©ì„±ê³¼ ì•ˆì •ì„±ì´ë‹¤.</span>"</p>
            </blockquote>
          </div>
        </div>
      </div>

      <!-- Section 1: Overview -->
      <section id="overview" class="space-y-4">
        <button onclick="toggleSection('overview-content')" class="w-full gradient-border rounded-2xl p-5 card-hover cursor-pointer text-left group">
          <div class="flex items-center justify-between">
            <div class="flex items-center gap-4">
              <div class="w-12 h-12 rounded-xl bg-gradient-to-br from-cyan-400 to-blue-500 flex items-center justify-center">
                <span class="text-2xl">ğŸ¯</span>
              </div>
              <div>
                <h2 class="text-xl font-bold text-white">1. ê³¼ì œì˜ ì„±ê²© ì´í•´í•˜ê¸°</h2>
                <p class="text-sm text-slate-400">System Operation vs Application Development</p>
              </div>
            </div>
            <svg class="w-6 h-6 text-slate-400 transform transition-transform section-arrow" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
            </svg>
          </div>
        </button>

        <div id="overview-content" class="section-content">
          <div class="bg-slate-800/50 rounded-2xl p-6 border border-slate-700/50 space-y-6">
            <div class="p-4 rounded-xl bg-rose-500/10 border border-rose-500/30">
              <p class="text-rose-400 font-semibold">
                âš ï¸ ì´ ê³¼ì œëŠ” <span class="underline">ì• í”Œë¦¬ì¼€ì´ì…˜ ê°œë°œ ê³¼ì œ</span>ê°€ ì•„ë‹ˆë¼ <span class="underline">ì‹œìŠ¤í…œ ìš´ì˜(System Operation) ê³¼ì œ</span>ì…ë‹ˆë‹¤.
              </p>
            </div>

            <div>
              <h3 class="text-lg font-semibold text-cyan-400 mb-4 flex items-center gap-2"><span>âœ”</span> í•µì‹¬ ëª©í‘œ</h3>
              <div class="grid sm:grid-cols-2 gap-3">
                <div class="flex items-center gap-3 p-4 rounded-xl bg-slate-700/30 border border-slate-600/30">
                  <span class="text-2xl">ğŸŒ</span>
                  <span class="text-slate-200">ì„œë¹„ìŠ¤ë¥¼ ì™¸ë¶€ ì‚¬ìš©ìì—ê²Œ <strong class="text-cyan-400">ì•ˆì •ì ìœ¼ë¡œ ì œê³µ</strong></span>
                </div>
                <div class="flex items-center gap-3 p-4 rounded-xl bg-slate-700/30 border border-slate-600/30">
                  <span class="text-2xl">âš¡</span>
                  <span class="text-slate-200">íŠ¸ë˜í”½ ìƒí™©ì—ì„œë„ <strong class="text-cyan-400">ëª©í‘œ ì‘ë‹µì‹œê°„(SLO)</strong> ìœ ì§€</span>
                </div>
                <div class="flex items-center gap-3 p-4 rounded-xl bg-slate-700/30 border border-slate-600/30">
                  <span class="text-2xl">ğŸ”</span>
                  <span class="text-slate-200">ì¥ì•  ë° ì˜¤ë¥˜ë¥¼ <strong class="text-cyan-400">ë¹ ë¥´ê²Œ ê°ì§€</strong>í•˜ê³  ëŒ€ì‘</span>
                </div>
                <div class="flex items-center gap-3 p-4 rounded-xl bg-slate-700/30 border border-slate-600/30">
                  <span class="text-2xl">ğŸ’°</span>
                  <span class="text-slate-200">ë¶ˆí•„ìš”í•œ ë¦¬ì†ŒìŠ¤ ì—†ì´ <strong class="text-cyan-400">ë¹„ìš© íš¨ìœ¨ì ìœ¼ë¡œ ìš´ì˜</strong></span>
                </div>
              </div>
            </div>

            <div class="p-4 rounded-xl bg-violet-500/10 border border-violet-500/30">
              <p class="text-violet-300 text-center text-lg font-medium">ğŸ‘‰ "ë™ì‘í•œë‹¤"ë³´ë‹¤ "<strong class="text-violet-400">ìš´ì˜í•  ìˆ˜ ìˆë‹¤</strong>"ê°€ ì¤‘ìš”í•¨</p>
            </div>
          </div>
        </div>
      </section>

      <!-- Section 2: Architecture -->
      <section id="architecture" class="space-y-4">
        <button onclick="toggleSection('architecture-content')" class="w-full gradient-border rounded-2xl p-5 card-hover cursor-pointer text-left group">
          <div class="flex items-center justify-between">
            <div class="flex items-center gap-4">
              <div class="w-12 h-12 rounded-xl bg-gradient-to-br from-violet-400 to-purple-500 flex items-center justify-center">
                <span class="text-2xl">ğŸ—ï¸</span>
              </div>
              <div>
                <h2 class="text-xl font-bold text-white">2. ì „ì²´ ì•„í‚¤í…ì²˜</h2>
                <p class="text-sm text-slate-400">ë‹¨ì¼ ì—”ë“œí¬ì¸íŠ¸ Â· ê²½ë¡œ ê¸°ë°˜ ë¼ìš°íŒ… Â· ECS ì„œë¹„ìŠ¤ ë¶„ë¦¬</p>
              </div>
            </div>
            <svg class="w-6 h-6 text-slate-400 transform transition-transform section-arrow" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
            </svg>
          </div>
        </button>

        <div id="architecture-content" class="section-content">
          <div class="bg-slate-800/50 rounded-2xl p-6 border border-slate-700/50 space-y-6">
            <div>
              <h3 class="text-lg font-semibold text-violet-400 mb-4">ğŸ“¡ íŠ¸ë˜í”½ íë¦„</h3>
              <div class="flex flex-wrap items-center justify-center gap-2 sm:gap-4 p-6 rounded-xl bg-slate-900/50 border border-slate-700/50">
                <div class="px-4 py-2 rounded-lg bg-emerald-500/20 border border-emerald-500/40 text-emerald-400 font-medium mono text-sm">Client</div>
                <span class="text-slate-500">â†’</span>
                <div class="px-4 py-2 rounded-lg bg-cyan-500/20 border border-cyan-500/40 text-cyan-400 font-medium mono text-sm">ALB (ë‹¨ì¼ ë„ë©”ì¸)</div>
                <span class="text-slate-500">â†’</span>
                <div class="px-4 py-2 rounded-lg bg-violet-500/20 border border-violet-500/40 text-violet-400 font-medium mono text-sm">Path Rule</div>
                <span class="text-slate-500">â†’</span>
                <div class="px-4 py-2 rounded-lg bg-amber-500/20 border border-amber-500/40 text-amber-400 font-medium mono text-sm">ECS Service (awsvpc)</div>
                <span class="text-slate-500">â†’</span>
                <div class="px-4 py-2 rounded-lg bg-rose-500/20 border border-rose-500/40 text-rose-400 font-medium mono text-sm">RDS / DynamoDB</div>
              </div>
            </div>

            <div>
              <h3 class="text-lg font-semibold text-violet-400 mb-4">ğŸ”Œ API êµ¬ì„±</h3>
              <div class="overflow-x-auto rounded-xl border border-slate-700/50">
                <table class="w-full">
                  <thead class="bg-slate-700/50">
                    <tr>
                      <th class="px-4 py-3 text-left text-sm font-semibold text-slate-300">ê²½ë¡œ</th>
                      <th class="px-4 py-3 text-left text-sm font-semibold text-slate-300">ë¼ìš°íŒ…</th>
                      <th class="px-4 py-3 text-left text-sm font-semibold text-slate-300">ë°ì´í„° ì €ì¥ì†Œ</th>
                    </tr>
                  </thead>
                  <tbody class="divide-y divide-slate-700/50">
                    <tr class="bg-slate-800/30 hover:bg-slate-700/30 transition-colors">
                      <td class="px-4 py-3 mono text-cyan-400 text-sm">/v1/user</td>
                      <td class="px-4 py-3 text-slate-300 text-sm">ALB Rule â†’ TG(user) â†’ ECS Service(user)</td>
                      <td class="px-4 py-3 text-sm"><span class="px-2 py-1 rounded bg-blue-500/20 text-blue-400 text-xs font-medium">RDS(MySQL, Multi-AZ)</span></td>
                    </tr>
                    <tr class="bg-slate-800/30 hover:bg-slate-700/30 transition-colors">
                      <td class="px-4 py-3 mono text-cyan-400 text-sm">/v1/product</td>
                      <td class="px-4 py-3 text-slate-300 text-sm">ALB Rule â†’ TG(product) â†’ ECS Service(product)</td>
                      <td class="px-4 py-3 text-sm"><span class="px-2 py-1 rounded bg-amber-500/20 text-amber-400 text-xs font-medium">DynamoDB</span></td>
                    </tr>
                    <tr class="bg-slate-800/30 hover:bg-slate-700/30 transition-colors">
                      <td class="px-4 py-3 mono text-cyan-400 text-sm">/v1/stress</td>
                      <td class="px-4 py-3 text-slate-300 text-sm">ALB Rule â†’ TG(stress) â†’ ECS Service(stress)</td>
                      <td class="px-4 py-3 text-sm"><span class="px-2 py-1 rounded bg-slate-500/20 text-slate-400 text-xs font-medium">ì—†ìŒ</span></td>
                    </tr>
                  </tbody>
                </table>
              </div>
              <p class="mt-3 text-sm text-slate-400 flex items-center gap-2"><span>âœ”</span> Target Groupì€ <span class="mono text-cyan-400">target_type = ip</span> (awsvpc Task IP ë“±ë¡)</p>
            </div>
          </div>
        </div>
      </section>

      <!-- Section 3: APIs Detail (ìš”ì•½) -->
      <section id="apis" class="space-y-4">
        <button onclick="toggleSection('apis-content')" class="w-full gradient-border rounded-2xl p-5 card-hover cursor-pointer text-left group">
          <div class="flex items-center justify-between">
            <div class="flex items-center gap-4">
              <div class="w-12 h-12 rounded-xl bg-gradient-to-br from-amber-400 to-orange-500 flex items-center justify-center"><span class="text-2xl">ğŸ”Œ</span></div>
              <div>
                <h2 class="text-xl font-bold text-white">3. API í•µì‹¬ ê·œì¹™</h2>
                <p class="text-sm text-slate-400">ì‘ë‹µ ê·œì¹™ Â· healthcheck Â· ìš´ì˜ í¬ì¸íŠ¸</p>
              </div>
            </div>
            <svg class="w-6 h-6 text-slate-400 transform transition-transform section-arrow" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
            </svg>
          </div>
        </button>

        <div id="apis-content" class="section-content">
          <div class="bg-slate-800/50 rounded-2xl p-6 border border-slate-700/50 space-y-6">
            <div class="grid md:grid-cols-3 gap-4">
              <div class="p-5 rounded-2xl border border-slate-700/50 bg-slate-900/40 space-y-2">
                <div class="flex items-center justify-between">
                  <span class="px-3 py-1 rounded-full bg-blue-500/20 text-blue-400 text-sm font-semibold">USER</span>
                  <span class="mono text-slate-400 text-sm">/v1/user</span>
                </div>
                <p class="text-sm text-slate-300">RDS(MySQL) ì—°ê²°, Multi-AZ í•„ìˆ˜</p>
                <p class="text-xs text-slate-400">health: <span class="mono">/healthcheck</span></p>
              </div>

              <div class="p-5 rounded-2xl border border-slate-700/50 bg-slate-900/40 space-y-2">
                <div class="flex items-center justify-between">
                  <span class="px-3 py-1 rounded-full bg-amber-500/20 text-amber-400 text-sm font-semibold">PRODUCT</span>
                  <span class="mono text-slate-400 text-sm">/v1/product</span>
                </div>
                <p class="text-sm text-slate-300">DynamoDB í…Œì´ë¸” 1ê°œ, PK ì„¤ê³„ ì¤‘ìš”</p>
                <p class="text-xs text-slate-400">ë¹„ì •ìƒ ì…ë ¥ì€ ì •ì±… ê³„ì¸µ(ALB/WAF)ì—ì„œ ì²˜ë¦¬ ê¶Œì¥</p>
              </div>

              <div class="p-5 rounded-2xl border border-slate-700/50 bg-slate-900/40 space-y-2">
                <div class="flex items-center justify-between">
                  <span class="px-3 py-1 rounded-full bg-rose-500/20 text-rose-400 text-sm font-semibold">STRESS</span>
                  <span class="mono text-slate-400 text-sm">/v1/stress</span>
                </div>
                <p class="text-sm text-slate-300">CPU/ë©”ëª¨ë¦¬ ë¶€í•˜ ìœ ë°œ, ëª¨ë‹ˆí„°ë§ì´ ì±„ì  í¬ì¸íŠ¸</p>
                <p class="text-xs text-slate-400">CPU/Latency/5xx ë³€í™”ë¥¼ ë¹„êµ</p>
              </div>
            </div>

            <div class="overflow-hidden rounded-xl border border-slate-700/50">
              <table class="w-full text-sm">
                <thead class="bg-slate-700/50">
                  <tr>
                    <th class="px-4 py-3 text-left text-slate-300">ìš”ì²­ ìœ í˜•</th>
                    <th class="px-4 py-3 text-left text-slate-300">ì‘ë‹µ ì½”ë“œ</th>
                    <th class="px-4 py-3 text-left text-slate-300">ìš´ì˜ ë©”ëª¨</th>
                  </tr>
                </thead>
                <tbody class="divide-y divide-slate-700/50">
                  <tr class="bg-slate-800/30">
                    <td class="px-4 py-3 text-slate-300">ì •ìƒ API ìš”ì²­</td>
                    <td class="px-4 py-3"><span class="px-2 py-0.5 rounded bg-emerald-500/20 text-emerald-400 mono">200 / 201</span></td>
                    <td class="px-4 py-3 text-slate-400">ì •ìƒ íŠ¸ë˜í”½ ê¸°ì¤€ì„ (Baseline) í™•ë³´</td>
                  </tr>
                  <tr class="bg-slate-800/30">
                    <td class="px-4 py-3 text-slate-300">API ê²½ë¡œì§€ë§Œ ë¹„ì •ìƒ</td>
                    <td class="px-4 py-3"><span class="px-2 py-0.5 rounded bg-amber-500/20 text-amber-400 mono">403</span></td>
                    <td class="px-4 py-3 text-slate-400">ALB Listener Rule / WAF / Auth ê³„ì¸µì—ì„œ ì²˜ë¦¬</td>
                  </tr>
                  <tr class="bg-slate-800/30">
                    <td class="px-4 py-3 text-slate-300">ì¡´ì¬í•˜ì§€ ì•ŠëŠ” ê²½ë¡œ</td>
                    <td class="px-4 py-3"><span class="px-2 py-0.5 rounded bg-rose-500/20 text-rose-400 mono">404</span></td>
                    <td class="px-4 py-3 text-slate-400">Default Action ë°˜í™˜ í™•ì¸</td>
                  </tr>
                </tbody>
              </table>
            </div>

            <div class="p-4 rounded-xl bg-pink-500/10 border border-pink-500/30">
              <p class="text-pink-200 text-sm">
                ğŸ“¤ ì œì¶œ ì—”ë“œí¬ì¸íŠ¸ ê·œì¹™: <strong class="text-pink-400">í”„ë¡œí† ì½œ í¬í•¨ ë„ë©”ì¸ë§Œ</strong> ì œì¶œ (ê²½ë¡œ ê¸ˆì§€)
              </p>
              <div class="grid md:grid-cols-2 gap-3 mt-3">
                <div class="p-3 rounded-lg bg-emerald-500/10 border border-emerald-500/30">
                  <p class="text-xs text-slate-400 mb-1">âœ… ì •ìƒ ì˜ˆì‹œ</p>
                  <p class="mono text-emerald-400">https://example.org</p>
                </div>
                <div class="p-3 rounded-lg bg-rose-500/10 border border-rose-500/30">
                  <p class="text-xs text-slate-400 mb-1">âŒ ì˜ëª»ëœ ì˜ˆì‹œ</p>
                  <p class="mono text-rose-400 line-through">example.org</p>
                  <p class="text-xs text-slate-500">(í”„ë¡œí† ì½œ ì—†ìŒ)</p>
                  <p class="mono text-rose-400 line-through mt-1">https://example.org/v1</p>
                  <p class="text-xs text-slate-500">(ê²½ë¡œ í¬í•¨)</p>
                </div>
              </div>
            </div>

          </div>
        </div>
      </section>

      <!-- Section 4: Terraform (ìš´ì˜í˜• ì •ì„) -->
      <section id="terraform" class="space-y-4">
        <button onclick="toggleSection('terraform-content')" class="w-full gradient-border rounded-2xl p-5 card-hover cursor-pointer text-left group">
          <div class="flex items-center justify-between">
            <div class="flex items-center gap-4">
              <div class="w-12 h-12 rounded-xl bg-gradient-to-br from-purple-400 to-indigo-500 flex items-center justify-center"><span class="text-2xl">ğŸ§±</span></div>
              <div>
                <h2 class="text-xl font-bold text-white">4. Terraform ì½”ë“œ (ìš´ì˜í˜• ì •ì„)</h2>
                <p class="text-sm text-slate-400">ALB + ECS(EC2, awsvpc) + ECS Service + TG(ip) + RDS + DynamoDB</p>
              </div>
            </div>
            <svg class="w-6 h-6 text-slate-400 transform transition-transform section-arrow" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
            </svg>
          </div>
        </button>

        <div id="terraform-content" class="section-content">
          <div class="bg-slate-800/50 rounded-2xl p-6 border border-slate-700/50 space-y-8">

            <!-- Guide -->
            <div class="p-4 rounded-xl bg-violet-500/10 border border-violet-500/30">
              <p class="text-violet-200 text-sm">
                âœ… í•µì‹¬ ì„¤ê³„: ALBëŠ” Public Subnet, ECS EC2 í˜¸ìŠ¤íŠ¸ëŠ” Private Subnet(awsvpc Task IP), PrivateëŠ” NATë¡œ ECR/CloudWatch ì ‘ê·¼.
                Target Groupì€ <span class="mono text-violet-300">ip</span>ë¡œ Task IP ë“±ë¡.
              </p>
            </div>

            <!-- 0) variables -->
            <div>
              <h3 class="text-lg font-semibold text-purple-400 mb-3">0) variables.tf</h3>
              <div class="code-card code-wrap mono text-sm text-slate-200">
<pre>variable "region" {
  type    = string
  default = "ap-northeast-2"
}

variable "project" {
  type    = string
  default = "skills-ops"
}

variable "db_name" {
  type    = string
  default = "myapp"
}

variable "db_user" {
  type    = string
  default = "admin"
}

variable "db_password" {
  type      = string
  sensitive = true
}

# ECS ì»¨í…Œì´ë„ˆ ì´ë¯¸ì§€ (ì˜ˆ: ECR URI)
variable "image_user" {
  type = string
}

variable "image_product" {
  type = string
}

variable "image_stress" {
  type = string
}</pre>
              </div>
            </div>

            <!-- 1) provider -->
            <div>
              <h3 class="text-lg font-semibold text-purple-400 mb-3">1) provider.tf</h3>
              <div class="code-card code-wrap mono text-sm text-slate-200">
<pre>terraform {
  required_providers {
    aws = {
      source  = "hashicorp/aws"
      version = "~&gt; 5.0"
    }
  }
}

provider "aws" {
  region = var.region
}</pre>
              </div>
            </div>

            <!-- 2) network -->
            <div>
              <h3 class="text-lg font-semibold text-purple-400 mb-3">2) network.tf (VPC, Subnet, IGW, NAT, Route)</h3>
              <div class="code-card code-wrap mono text-sm text-slate-200">
<pre>data "aws_availability_zones" "available" {
  state = "available"
}

resource "aws_vpc" "main" {
  cidr_block           = "10.0.0.0/16"
  enable_dns_support   = true
  enable_dns_hostnames = true
  tags = { Name = "${var.project}-vpc" }
}

resource "aws_internet_gateway" "igw" {
  vpc_id = aws_vpc.main.id
  tags = { Name = "${var.project}-igw" }
}

# Public subnets (ALB)
resource "aws_subnet" "public_a" {
  vpc_id                  = aws_vpc.main.id
  cidr_block              = "10.0.1.0/24"
  availability_zone       = data.aws_availability_zones.available.names[0]
  map_public_ip_on_launch = true
  tags = { Name = "${var.project}-public-a" }
}

resource "aws_subnet" "public_c" {
  vpc_id                  = aws_vpc.main.id
  cidr_block              = "10.0.2.0/24"
  availability_zone       = data.aws_availability_zones.available.names[1]
  map_public_ip_on_launch = true
  tags = { Name = "${var.project}-public-c" }
}

# Private subnets (ECS hosts + tasks, RDS)
resource "aws_subnet" "private_a" {
  vpc_id            = aws_vpc.main.id
  cidr_block        = "10.0.10.0/24"
  availability_zone = data.aws_availability_zones.available.names[0]
  tags = { Name = "${var.project}-private-a" }
}

resource "aws_subnet" "private_c" {
  vpc_id            = aws_vpc.main.id
  cidr_block        = "10.0.11.0/24"
  availability_zone = data.aws_availability_zones.available.names[1]
  tags = { Name = "${var.project}-private-c" }
}

# Public route table
resource "aws_route_table" "public" {
  vpc_id = aws_vpc.main.id
  route {
    cidr_block = "0.0.0.0/0"
    gateway_id = aws_internet_gateway.igw.id
  }
  tags = { Name = "${var.project}-rt-public" }
}

resource "aws_route_table_association" "public_a" {
  subnet_id      = aws_subnet.public_a.id
  route_table_id = aws_route_table.public.id
}

resource "aws_route_table_association" "public_c" {
  subnet_id      = aws_subnet.public_c.id
  route_table_id = aws_route_table.public.id
}

# NAT (ë‹¨ì¼ NAT ì˜ˆì‹œ: ì‹¤ì „ì€ AZë³„ 2ê°œê°€ ë² ìŠ¤íŠ¸)
resource "aws_eip" "nat" {
  domain = "vpc"
  tags = { Name = "${var.project}-nat-eip" }
}

resource "aws_nat_gateway" "nat" {
  allocation_id = aws_eip.nat.id
  subnet_id     = aws_subnet.public_a.id
  tags = { Name = "${var.project}-nat" }
  depends_on = [aws_internet_gateway.igw]
}

# Private route table
resource "aws_route_table" "private" {
  vpc_id = aws_vpc.main.id
  route {
    cidr_block     = "0.0.0.0/0"
    nat_gateway_id = aws_nat_gateway.nat.id
  }
  tags = { Name = "${var.project}-rt-private" }
}

resource "aws_route_table_association" "private_a" {
  subnet_id      = aws_subnet.private_a.id
  route_table_id = aws_route_table.private.id
}

resource "aws_route_table_association" "private_c" {
  subnet_id      = aws_subnet.private_c.id
  route_table_id = aws_route_table.private.id
}</pre>
              </div>
            </div>

            <!-- 3) security groups -->
            <div>
              <h3 class="text-lg font-semibold text-purple-400 mb-3">3) security_groups.tf (ìµœì†Œ ê¶Œí•œ)</h3>
              <div class="code-card code-wrap mono text-sm text-slate-200">
<pre>resource "aws_security_group" "alb" {
  name   = "${var.project}-alb-sg"
  vpc_id = aws_vpc.main.id

  ingress {
    from_port   = 80
    to_port     = 80
    protocol    = "tcp"
    cidr_blocks = ["0.0.0.0/0"]
  }

  # í•„ìš” ì‹œ 443 ì¶”ê°€(ì¸ì¦ì„œ/ACM êµ¬ì„± í›„)
  # ingress {
  #   from_port   = 443
  #   to_port     = 443
  #   protocol    = "tcp"
  #   cidr_blocks = ["0.0.0.0/0"]
  # }

  egress {
    from_port   = 0
    to_port     = 0
    protocol    = "-1"
    cidr_blocks = ["0.0.0.0/0"]
  }

  tags = { Name = "${var.project}-alb-sg" }
}

# ECS Tasks (awsvpc Task ENIê°€ ë¶™ëŠ” SG)
resource "aws_security_group" "ecs_task" {
  name   = "${var.project}-ecs-task-sg"
  vpc_id = aws_vpc.main.id

  # ALBì—ì„œ ì»¨í…Œì´ë„ˆ í¬íŠ¸(ì˜ˆ: 8080)ë§Œ í—ˆìš©
  ingress {
    from_port       = 8080
    to_port         = 8080
    protocol        = "tcp"
    security_groups = [aws_security_group.alb.id]
  }

  egress {
    from_port   = 0
    to_port     = 0
    protocol    = "-1"
    cidr_blocks = ["0.0.0.0/0"]
  }

  tags = { Name = "${var.project}-ecs-task-sg" }
}

# ECS EC2 Host (í˜¸ìŠ¤íŠ¸ëŠ” ì™¸ë¶€ ì¸ë°”ìš´ë“œ ë¶ˆí•„ìš”, ì•„ì›ƒë°”ìš´ë“œë§Œ)
resource "aws_security_group" "ecs_host" {
  name   = "${var.project}-ecs-host-sg"
  vpc_id = aws_vpc.main.id

  egress {
    from_port   = 0
    to_port     = 0
    protocol    = "-1"
    cidr_blocks = ["0.0.0.0/0"]
  }

  tags = { Name = "${var.project}-ecs-host-sg" }
}

# RDS
resource "aws_security_group" "rds" {
  name   = "${var.project}-rds-sg"
  vpc_id = aws_vpc.main.id

  ingress {
    from_port       = 3306
    to_port         = 3306
    protocol        = "tcp"
    security_groups = [aws_security_group.ecs_task.id]
  }

  egress {
    from_port   = 0
    to_port     = 0
    protocol    = "-1"
    cidr_blocks = ["0.0.0.0/0"]
  }

  tags = { Name = "${var.project}-rds-sg" }
}</pre>
              </div>
            </div>

            <!-- 4) ALB + TG + Listener Rules -->
            <div>
              <h3 class="text-lg font-semibold text-purple-400 mb-3">4) alb.tf (TG: ip, Path Rule)</h3>
              <div class="code-card code-wrap mono text-sm text-slate-200">
<pre>resource "aws_lb" "main" {
  name               = "${var.project}-alb"
  internal           = false
  load_balancer_type = "application"
  security_groups    = [aws_security_group.alb.id]
  subnets            = [aws_subnet.public_a.id, aws_subnet.public_c.id]
  tags = { Name = "${var.project}-alb" }
}

# Target Groups: awsvpc Task IP ë“±ë¡
resource "aws_lb_target_group" "user" {
  name        = "${var.project}-tg-user"
  port        = 8080
  protocol    = "HTTP"
  vpc_id      = aws_vpc.main.id
  target_type = "ip"

  health_check {
    path                = "/healthcheck"
    matcher             = "200"
    interval            = 15
    timeout             = 5
    healthy_threshold   = 2
    unhealthy_threshold = 3
  }
}

resource "aws_lb_target_group" "product" {
  name        = "${var.project}-tg-product"
  port        = 8080
  protocol    = "HTTP"
  vpc_id      = aws_vpc.main.id
  target_type = "ip"

  health_check {
    path                = "/healthcheck"
    matcher             = "200"
    interval            = 15
    timeout             = 5
    healthy_threshold   = 2
    unhealthy_threshold = 3
  }
}

resource "aws_lb_target_group" "stress" {
  name        = "${var.project}-tg-stress"
  port        = 8080
  protocol    = "HTTP"
  vpc_id      = aws_vpc.main.id
  target_type = "ip"

  health_check {
    path                = "/healthcheck"
    matcher             = "200"
    interval            = 15
    timeout             = 5
    healthy_threshold   = 2
    unhealthy_threshold = 3
  }
}

resource "aws_lb_listener" "http" {
  load_balancer_arn = aws_lb.main.arn
  port              = 80
  protocol          = "HTTP"

  # ê¸°ë³¸ì€ 404ë¡œ ì²˜ë¦¬(ì¡´ì¬í•˜ì§€ ì•ŠëŠ” ê²½ë¡œ)
  default_action {
    type = "fixed-response"
    fixed_response {
      content_type = "text/plain"
      message_body = "Not Found"
      status_code  = "404"
    }
  }
}

# Path Rules
resource "aws_lb_listener_rule" "user" {
  listener_arn = aws_lb_listener.http.arn
  priority     = 10

  action {
    type             = "forward"
    target_group_arn = aws_lb_target_group.user.arn
  }

  condition {
    path_pattern {
      values = ["/v1/user*", "/healthcheck"]
    }
  }
}

resource "aws_lb_listener_rule" "product" {
  listener_arn = aws_lb_listener.http.arn
  priority     = 20

  action {
    type             = "forward"
    target_group_arn = aws_lb_target_group.product.arn
  }

  condition {
    path_pattern {
      values = ["/v1/product*"]
    }
  }
}

resource "aws_lb_listener_rule" "stress" {
  listener_arn = aws_lb_listener.http.arn
  priority     = 30

  action {
    type             = "forward"
    target_group_arn = aws_lb_target_group.stress.arn
  }

  condition {
    path_pattern {
      values = ["/v1/stress*"]
    }
  }
}</pre>
              </div>
            </div>

            <!-- 5) DynamoDB -->
            <div>
              <h3 class="text-lg font-semibold text-purple-400 mb-3">5) dynamodb.tf</h3>
              <div class="code-card code-wrap mono text-sm text-slate-200">
<pre>resource "aws_dynamodb_table" "products" {
  name         = "${var.project}-products"
  billing_mode = "PAY_PER_REQUEST"
  hash_key     = "id"

  attribute {
    name = "id"
    type = "S"
  }

  tags = { Name = "${var.project}-products" }
}</pre>
              </div>
            </div>

            <!-- 6) RDS -->
            <div>
              <h3 class="text-lg font-semibold text-purple-400 mb-3">6) rds.tf (Multi-AZ, Private)</h3>
              <div class="code-card code-wrap mono text-sm text-slate-200">
<pre>resource "aws_db_subnet_group" "main" {
  name       = "${var.project}-db-subnet"
  subnet_ids = [aws_subnet.private_a.id, aws_subnet.private_c.id]
}

resource "aws_db_instance" "mysql" {
  identifier               = "${var.project}-mysql"
  engine                   = "mysql"
  engine_version           = "8.0"
  instance_class           = "db.t3.micro"
  allocated_storage        = 20
  storage_type             = "gp3"
  db_name                  = var.db_name
  username                 = var.db_user
  password                 = var.db_password

  db_subnet_group_name     = aws_db_subnet_group.main.name
  vpc_security_group_ids   = [aws_security_group.rds.id]

  multi_az                 = true
  publicly_accessible      = false

  backup_retention_period  = 7

  # ëŒ€íšŒ/ì‹¤ìŠµ í™˜ê²½ì—ì„œëŠ” ì‚­ì œ í¸ì˜ ìœ„í•´ true ê¶Œì¥
  skip_final_snapshot      = true
  deletion_protection      = false

  tags = { Name = "${var.project}-mysql" }
}</pre>
              </div>
            </div>

            <!-- 7) IAM -->
            <div>
              <h3 class="text-lg font-semibold text-purple-400 mb-3">7) iam.tf (ECS Host + Task Execution)</h3>
              <div class="code-card code-wrap mono text-sm text-slate-200">
<pre># ECS EC2 Host Role
resource "aws_iam_role" "ecs_instance_role" {
  name = "${var.project}-ecs-instance-role"
  assume_role_policy = jsonencode({
    Version = "2012-10-17"
    Statement = [{
      Effect    = "Allow"
      Action    = "sts:AssumeRole"
      Principal = { Service = "ec2.amazonaws.com" }
    }]
  })
}

resource "aws_iam_instance_profile" "ecs" {
  name = "${var.project}-ecs-instance-profile"
  role = aws_iam_role.ecs_instance_role.name
}

resource "aws_iam_role_policy_attachment" "ecs_instance" {
  role       = aws_iam_role.ecs_instance_role.name
  policy_arn = "arn:aws:iam::aws:policy/service-role/AmazonEC2ContainerServiceforEC2Role"
}

# (ê°•ì¶”) SSMìœ¼ë¡œ ì¸ìŠ¤í„´ìŠ¤ ì ê²€/ì ‘ì†
resource "aws_iam_role_policy_attachment" "ecs_instance_ssm" {
  role       = aws_iam_role.ecs_instance_role.name
  policy_arn = "arn:aws:iam::aws:policy/AmazonSSMManagedInstanceCore"
}

# ECS Task Execution Role (ECR pull, CloudWatch logs)
resource "aws_iam_role" "ecs_task_execution" {
  name = "${var.project}-ecs-task-exec-role"
  assume_role_policy = jsonencode({
    Version = "2012-10-17"
    Statement = [{
      Effect    = "Allow"
      Action    = "sts:AssumeRole"
      Principal = { Service = "ecs-tasks.amazonaws.com" }
    }]
  })
}

resource "aws_iam_role_policy_attachment" "ecs_task_execution" {
  role       = aws_iam_role.ecs_task_execution.name
  policy_arn = "arn:aws:iam::aws:policy/service-role/AmazonECSTaskExecutionRolePolicy"
}</pre>
              </div>
            </div>

            <!-- 8) ECS Cluster + ASG + Capacity Provider -->
            <div>
              <h3 class="text-lg font-semibold text-purple-400 mb-3">8) ecs_cluster_ec2.tf (ASG + Capacity Provider)</h3>
              <div class="code-card code-wrap mono text-sm text-slate-200">
<pre>resource "aws_ecs_cluster" "main" {
  name = "${var.project}-cluster"

  setting {
    name  = "containerInsights"
    value = "enabled"
  }
}

data "aws_ami" "ecs" {
  most_recent = true
  owners      = ["amazon"]
  filter {
    name   = "name"
    values = ["amzn2-ami-ecs-hvm-*-x86_64-ebs"]
  }
}

resource "aws_launch_template" "ecs" {
  name_prefix   = "${var.project}-lt-"
  image_id      = data.aws_ami.ecs.id
  instance_type = "t3.medium"

  vpc_security_group_ids = [aws_security_group.ecs_host.id]

  iam_instance_profile {
    name = aws_iam_instance_profile.ecs.name
  }

  user_data = base64encode(<<-EOF
    #!/bin/bash
    echo "ECS_CLUSTER=${aws_ecs_cluster.main.name}" >> /etc/ecs/ecs.config
  EOF
  )

  tag_specifications {
    resource_type = "instance"
    tags = { Name = "${var.project}-ecs-host" }
  }
}

resource "aws_autoscaling_group" "ecs" {
  name                = "${var.project}-asg"
  max_size            = 2
  min_size            = 2
  desired_capacity    = 2
  vpc_zone_identifier = [aws_subnet.private_a.id, aws_subnet.private_c.id]

  launch_template {
    id      = aws_launch_template.ecs.id
    version = "$Latest"
  }

  tag {
    key                 = "Name"
    value               = "${var.project}-ecs-host"
    propagate_at_launch = true
  }
}

resource "aws_ecs_capacity_provider" "ec2" {
  name = "${var.project}-cp-ec2"

  auto_scaling_group_provider {
    auto_scaling_group_arn = aws_autoscaling_group.ecs.arn

    managed_scaling {
      status                    = "ENABLED"
      target_capacity           = 80
      minimum_scaling_step_size = 1
      maximum_scaling_step_size = 2
    }

    managed_termination_protection = "DISABLED"
  }
}

resource "aws_ecs_cluster_capacity_providers" "main" {
  cluster_name       = aws_ecs_cluster.main.name
  capacity_providers = [aws_ecs_capacity_provider.ec2.name]

  default_capacity_provider_strategy {
    base              = 1
    weight            = 100
    capacity_provider = aws_ecs_capacity_provider.ec2.name
  }
}</pre>
              </div>
            </div>

            <!-- 9) ECS TaskDef + Service (3 services) -->
            <div>
              <h3 class="text-lg font-semibold text-purple-400 mb-3">9) ecs_services.tf (awsvpc, 3ê°œ ì„œë¹„ìŠ¤ ë¶„ë¦¬)</h3>
              <div class="code-card code-wrap mono text-sm text-slate-200">
<pre># ê³µí†µ CloudWatch Log Group (ì„ íƒ)
resource "aws_cloudwatch_log_group" "ecs" {
  name              = "/ecs/${var.project}"
  retention_in_days = 7
}

locals {
  container_port = 8080
  cpu            = 256
  memory         = 512
}

# USER Task Definition (RDS)
resource "aws_ecs_task_definition" "user" {
  family                   = "${var.project}-user"
  network_mode             = "awsvpc"
  requires_compatibilities = ["EC2"]
  cpu                      = tostring(local.cpu)
  memory                   = tostring(local.memory)
  execution_role_arn       = aws_iam_role.ecs_task_execution.arn

  container_definitions = jsonencode([{
    name  = "user"
    image = var.image_user
    essential = true
    portMappings = [{ containerPort = local.container_port, protocol = "tcp" }]
    environment = [
      { name = "DB_HOST", value = aws_db_instance.mysql.address },
      { name = "DB_NAME", value = var.db_name },
      { name = "DB_USER", value = var.db_user },
      # ë¹„ë°€ë²ˆí˜¸ëŠ” ì‹¤ì „ì—ì„œëŠ” Secrets Manager ê¶Œì¥ (ëŒ€íšŒ í™˜ê²½ì— ë§ì¶° ë‹¨ìˆœí™” ê°€ëŠ¥)
      { name = "DB_PASSWORD", value = var.db_password }
    ]
    logConfiguration = {
      logDriver = "awslogs"
      options = {
        awslogs-group         = aws_cloudwatch_log_group.ecs.name
        awslogs-region        = var.region
        awslogs-stream-prefix = "user"
      }
    }
  }])
}

# PRODUCT Task Definition (DynamoDB)
resource "aws_ecs_task_definition" "product" {
  family                   = "${var.project}-product"
  network_mode             = "awsvpc"
  requires_compatibilities = ["EC2"]
  cpu                      = tostring(local.cpu)
  memory                   = tostring(local.memory)
  execution_role_arn       = aws_iam_role.ecs_task_execution.arn

  container_definitions = jsonencode([{
    name  = "product"
    image = var.image_product
    essential = true
    portMappings = [{ containerPort = local.container_port, protocol = "tcp" }]
    environment = [
      { name = "DDB_TABLE", value = aws_dynamodb_table.products.name }
    ]
    logConfiguration = {
      logDriver = "awslogs"
      options = {
        awslogs-group         = aws_cloudwatch_log_group.ecs.name
        awslogs-region        = var.region
        awslogs-stream-prefix = "product"
      }
    }
  }])
}

# STRESS Task Definition
resource "aws_ecs_task_definition" "stress" {
  family                   = "${var.project}-stress"
  network_mode             = "awsvpc"
  requires_compatibilities = ["EC2"]
  cpu                      = tostring(local.cpu)
  memory                   = tostring(local.memory)
  execution_role_arn       = aws_iam_role.ecs_task_execution.arn

  container_definitions = jsonencode([{
    name  = "stress"
    image = var.image_stress
    essential = true
    portMappings = [{ containerPort = local.container_port, protocol = "tcp" }]
    logConfiguration = {
      logDriver = "awslogs"
      options = {
        awslogs-group         = aws_cloudwatch_log_group.ecs.name
        awslogs-region        = var.region
        awslogs-stream-prefix = "stress"
      }
    }
  }])
}

# ê³µí†µ ë„¤íŠ¸ì›Œí¬ (Private + NAT)
locals {
  service_subnets = [aws_subnet.private_a.id, aws_subnet.private_c.id]
}

resource "aws_ecs_service" "user" {
  name            = "${var.project}-svc-user"
  cluster         = aws_ecs_cluster.main.id
  task_definition = aws_ecs_task_definition.user.arn
  desired_count   = 2

  capacity_provider_strategy {
    capacity_provider = aws_ecs_capacity_provider.ec2.name
    weight            = 100
  }

  network_configuration {
    subnets         = local.service_subnets
    security_groups = [aws_security_group.ecs_task.id]
    assign_public_ip = false
  }

  load_balancer {
    target_group_arn = aws_lb_target_group.user.arn
    container_name   = "user"
    container_port   = local.container_port
  }

  depends_on = [aws_lb_listener.http]
}

resource "aws_ecs_service" "product" {
  name            = "${var.project}-svc-product"
  cluster         = aws_ecs_cluster.main.id
  task_definition = aws_ecs_task_definition.product.arn
  desired_count   = 2

  capacity_provider_strategy {
    capacity_provider = aws_ecs_capacity_provider.ec2.name
    weight            = 100
  }

  network_configuration {
    subnets         = local.service_subnets
    security_groups = [aws_security_group.ecs_task.id]
    assign_public_ip = false
  }

  load_balancer {
    target_group_arn = aws_lb_target_group.product.arn
    container_name   = "product"
    container_port   = local.container_port
  }

  depends_on = [aws_lb_listener.http]
}

resource "aws_ecs_service" "stress" {
  name            = "${var.project}-svc-stress"
  cluster         = aws_ecs_cluster.main.id
  task_definition = aws_ecs_task_definition.stress.arn
  desired_count   = 2

  capacity_provider_strategy {
    capacity_provider = aws_ecs_capacity_provider.ec2.name
    weight            = 100
  }

  network_configuration {
    subnets         = local.service_subnets
    security_groups = [aws_security_group.ecs_task.id]
    assign_public_ip = false
  }

  load_balancer {
    target_group_arn = aws_lb_target_group.stress.arn
    container_name   = "stress"
    container_port   = local.container_port
  }

  depends_on = [aws_lb_listener.http]
}</pre>
              </div>
            </div>

            <!-- 10) outputs -->
            <div>
              <h3 class="text-lg font-semibold text-purple-400 mb-3">10) outputs.tf</h3>
              <div class="code-card code-wrap mono text-sm text-slate-200">
<pre>output "alb_dns_name" {
  value = aws_lb.main.dns_name
}

output "rds_endpoint" {
  value = aws_db_instance.mysql.address
}

output "dynamodb_table" {
  value = aws_dynamodb_table.products.name
}</pre>
              </div>
            </div>

            <!-- Notes -->
            <div class="p-4 rounded-xl bg-amber-500/10 border border-amber-500/30">
              <p class="text-amber-200 text-sm">
                ìš´ì˜ ì²´í¬: (1) ECS Taskê°€ Privateì—ì„œ ECR Pull ë˜ëŠ”ì§€, (2) ALB Healthcheck 200 ìœ ì§€, (3) Stress í˜¸ì¶œ ì‹œ ALB 5xx/TargetResponseTime/CPU ë³€í™” í™•ì¸.
              </p>
            </div>

          </div>
        </div>
      </section>

      <!-- Checklist -->
      <section id="checklist" class="space-y-4">
        <div class="gradient-border rounded-2xl p-6">
          <div class="flex items-center gap-4 mb-6">
            <div class="w-12 h-12 rounded-xl bg-gradient-to-br from-emerald-400 to-green-500 flex items-center justify-center"><span class="text-2xl">âœ…</span></div>
            <div>
              <h2 class="text-xl font-bold text-white">5. ì‹¤ì „ ì²´í¬ë¦¬ìŠ¤íŠ¸</h2>
              <p class="text-sm text-slate-400">ì‹œí—˜ ì „ ìµœì¢… í™•ì¸ ì‚¬í•­</p>
            </div>
          </div>

          <div class="space-y-3" id="checklist-container">
            <label class="checklist-item flex items-center gap-3 p-4 rounded-xl bg-slate-700/30 border border-slate-600/30 cursor-pointer hover:bg-slate-700/50 transition-all">
              <input type="checkbox" class="w-5 h-5 rounded border-slate-500 text-emerald-500 focus:ring-emerald-500 focus:ring-offset-0 bg-slate-700" onchange="updateProgress()" />
              <span class="text-slate-200">ë¦¬ì „ <span class="mono text-cyan-400">ap-northeast-2</span> í™•ì¸</span>
            </label>

            <label class="checklist-item flex items-center gap-3 p-4 rounded-xl bg-slate-700/30 border border-slate-600/30 cursor-pointer hover:bg-slate-700/50 transition-all">
              <input type="checkbox" class="w-5 h-5 rounded border-slate-500 text-emerald-500 focus:ring-emerald-500 focus:ring-offset-0 bg-slate-700" onchange="updateProgress()" />
              <span class="text-slate-200">ALBëŠ” Public Subnet, ECS/DBëŠ” Private Subnet</span>
            </label>

            <label class="checklist-item flex items-center gap-3 p-4 rounded-xl bg-slate-700/30 border border-slate-600/30 cursor-pointer hover:bg-slate-700/50 transition-all">
              <input type="checkbox" class="w-5 h-5 rounded border-slate-500 text-emerald-500 focus:ring-emerald-500 focus:ring-offset-0 bg-slate-700" onchange="updateProgress()" />
              <span class="text-slate-200">Private â†’ NAT â†’ ECR Pull/CloudWatch ë¡œê·¸ ì „ì†¡ ê°€ëŠ¥</span>
            </label>

            <label class="checklist-item flex items-center gap-3 p-4 rounded-xl bg-slate-700/30 border border-slate-600/30 cursor-pointer hover:bg-slate-700/50 transition-all">
              <input type="checkbox" class="w-5 h-5 rounded border-slate-500 text-emerald-500 focus:ring-emerald-500 focus:ring-offset-0 bg-slate-700" onchange="updateProgress()" />
              <span class="text-slate-200">Target Group <span class="mono text-cyan-400">target_type=ip</span> í™•ì¸(awsvpc)</span>
            </label>

            <label class="checklist-item flex items-center gap-3 p-4 rounded-xl bg-slate-700/30 border border-slate-600/30 cursor-pointer hover:bg-slate-700/50 transition-all">
              <input type="checkbox" class="w-5 h-5 rounded border-slate-500 text-emerald-500 focus:ring-emerald-500 focus:ring-offset-0 bg-slate-700" onchange="updateProgress()" />
              <span class="text-slate-200">ëª¨ë“  <span class="mono text-cyan-400">/healthcheck</span> 200 ì‘ë‹µ</span>
            </label>

            <label class="checklist-item flex items-center gap-3 p-4 rounded-xl bg-slate-700/30 border border-slate-600/30 cursor-pointer hover:bg-slate-700/50 transition-all">
              <input type="checkbox" class="w-5 h-5 rounded border-slate-500 text-emerald-500 focus:ring-emerald-500 focus:ring-offset-0 bg-slate-700" onchange="updateProgress()" />
              <span class="text-slate-200">RDS Multi-AZ + Private + SG ìµœì†Œê¶Œí•œ(3306 from ECS Task SG)</span>
            </label>

            <label class="checklist-item flex items-center gap-3 p-4 rounded-xl bg-slate-700/30 border border-slate-600/30 cursor-pointer hover:bg-slate-700/50 transition-all">
              <input type="checkbox" class="w-5 h-5 rounded border-slate-500 text-emerald-500 focus:ring-emerald-500 focus:ring-offset-0 bg-slate-700" onchange="updateProgress()" />
              <span class="text-slate-200">ë„ë©”ì¸ë§Œ ì œì¶œ(í”„ë¡œí† ì½œ í¬í•¨, ê²½ë¡œ ì œì™¸)</span>
            </label>
          </div>

          <div id="completion-message" class="hidden mt-6 p-4 rounded-xl bg-emerald-500/20 border border-emerald-500/30 text-center">
            <span class="text-2xl">ğŸ‰</span>
            <p class="text-emerald-400 font-semibold mt-2">ëª¨ë“  í•­ëª©ì„ í™•ì¸í–ˆìŠµë‹ˆë‹¤!</p>
            <p class="text-slate-300 text-sm">ì‹œí—˜ ì¤€ë¹„ ì™„ë£Œ!</p>
          </div>
        </div>
      </section>
    </main>

    <!-- Footer -->
    <footer class="border-t border-slate-700/50 bg-slate-900/50 mt-12">
      <div class="max-w-7xl mx-auto px-4 sm:px-6 py-6 text-center">
        <p class="text-slate-500 text-sm">2025 ì „êµ­ê¸°ëŠ¥ê²½ê¸°ëŒ€íšŒ í´ë¼ìš°ë“œì»´í“¨íŒ… Â· System Operation í•™ìŠµ ëŒ€ì‹œë³´ë“œ</p>
      </div>
    </footer>
  </div>

  <script>
    const defaultConfig = {
      main_title: '2025 ì „êµ­ê¸°ëŠ¥ê²½ê¸°ëŒ€íšŒ',
      subtitle: 'í´ë¼ìš°ë“œì»´í“¨íŒ… ì œ3ê³¼ì œ Â· System Operation',
      primary_color: '#0f172a',
      secondary_color: '#1e293b',
      accent_color: '#38bdf8',
      text_color: '#e2e8f0',
      highlight_color: '#c084fc'
    };

    let config = { ...defaultConfig };

    function toggleSection(sectionId) {
      const content = document.getElementById(sectionId);
      const button = content.previousElementSibling;
      const arrow = button.querySelector('.section-arrow');

      if (content.classList.contains('expanded')) {
        content.classList.remove('expanded');
        arrow.style.transform = 'rotate(0deg)';
      } else {
        content.classList.add('expanded');
        arrow.style.transform = 'rotate(180deg)';
      }
    }

    function scrollToSection(sectionId) {
      const section = document.getElementById(sectionId);
      if (section) section.scrollIntoView({ behavior: 'smooth', block: 'start' });
    }

    function updateProgress() {
      const checkboxes = document.querySelectorAll('#checklist-container input[type="checkbox"]');
      const checked = Array.from(checkboxes).filter(cb => cb.checked).length;
      const total = checkboxes.length;
      const percentage = Math.round((checked / total) * 100);

      const circumference = 2 * Math.PI * 15.5;
      const offset = circumference - (percentage / 100) * circumference;

      document.getElementById('progress-ring').style.strokeDashoffset = offset;
      document.getElementById('progress-text').textContent = percentage + '%';

      checkboxes.forEach(cb => {
        const label = cb.closest('.checklist-item');
        if (cb.checked) label.classList.add('checked');
        else label.classList.remove('checked');
      });

      const completionMessage = document.getElementById('completion-message');
      if (percentage === 100) completionMessage.classList.remove('hidden');
      else completionMessage.classList.add('hidden');
    }

    async function onConfigChange(newConfig) {
      config = { ...config, ...newConfig };

      const mainTitle = document.getElementById('main-title');
      const subtitle = document.getElementById('subtitle');

      if (mainTitle) mainTitle.textContent = config.main_title || defaultConfig.main_title;
      if (subtitle) subtitle.textContent = config.subtitle || defaultConfig.subtitle;
    }

    function mapToCapabilities(config) {
      return {
        recolorables: [
          {
            get: () => config.primary_color || defaultConfig.primary_color,
            set: (value) => {
              config.primary_color = value;
              window.elementSdk.setConfig({ primary_color: value });
            }
          },
          {
            get: () => config.secondary_color || defaultConfig.secondary_color,
            set: (value) => {
              config.secondary_color = value;
              window.elementSdk.setConfig({ secondary_color: value });
            }
          },
          {
            get: () => config.accent_color || defaultConfig.accent_color,
            set: (value) => {
              config.accent_color = value;
              window.elementSdk.setConfig({ accent_color: value });
            }
          },
          {
            get: () => config.text_color || defaultConfig.text_color,
            set: (value) => {
              config.text_color = value;
              window.elementSdk.setConfig({ text_color: value });
            }
          },
          {
            get: () => config.highlight_color || defaultConfig.highlight_color,
            set: (value) => {
              config.highlight_color = value;
              window.elementSdk.setConfig({ highlight_color: value });
            }
          }
        ],
        borderables: [],
        fontEditable: undefined,
        fontSizeable: undefined
      };
    }

    function mapToEditPanelValues(config) {
      return new Map([
        ['main_title', config.main_title || defaultConfig.main_title],
        ['subtitle', config.subtitle || defaultConfig.subtitle]
      ]);
    }

    if (window.elementSdk) {
      window.elementSdk.init({
        defaultConfig,
        onConfigChange,
        mapToCapabilities,
        mapToEditPanelValues
      });
    }
  </script>
</body>
</html>
